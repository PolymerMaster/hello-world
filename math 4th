#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#define A2 51.6
#define Ttran 417.15
void zhuanhuan (double T[],double u[],double t[],double y[]);
void erchengfa (double t[],double y[],double A,double B,double C,double D,double E,double x1,double x2,double u0,double A1);
int main ()
{
    FILE *fs,*fp;
    double T[10],u[10]; //实验值
    double t[10],y[10]; //转换
    double A=0,B=0,C=0,D=0,E=0;
    double x1,x2,u0,A1;
    int i,k;
    fs=fopen ("E:\\wendu.txt","r");
    fp=fopen ("E:\\niandu.txt","r");
    if (fs==NULL||fp==NULL)
    {
        printf ("NO\n");
        exit(0);
    }
    for (i=0;i<10;i++)
    {
        fscanf (fs,"%lf",&T[i]);
        fscanf (fp,"%lf",&u[i]);
    }
    zhuanhuan (T,u,t,y);
    erchengfa (t,y,A,B,C,D,E,x1,x2,u0,A1);
    fclose(fs);
    fclose(fp);
    return 0;
}
void zhuanhuan (double T[],double u[],double t[],double y[])
{
    int k;
    for (k=0;k<10;k++)
    {
        t[k]=(T[k]-Ttran)/(A2+T[k]-Ttran);
        y[k]=log(u[k]);
    }
}
void erchengfa (double t[],double y[],double A,double B,double C,double D,double E,double x1,double x2,double u0,double A1)
{
    int j;
    for(j=0;j<10;j++)
    {
        A=10;
        B=B+t[j];
        C=C+y[j];
        D=D+pow(t[j],2);
        E=E+t[j]*y[j];
    }
    x1=(C*D-B*E)/(A*D-B*B);//线性关系，直接求解
    x2=(B*C-A*E)/(A*D-B*B);
    u0=exp(x1);
    A1=x2;
    printf ("A=%lf B=%lf C=%lf D=%lf E=%lf x1=%.4f x2=%.4f\n",A,B,C,D,E,x1,x2);
    printf ("u0=%e A1=%.4f\n",u0,A1);
}
